!function(){app.controller("addDomain",["$scope","http",function(t,n){t.domain={ym_name:"",ym_true_ip:"",ym_ip:""},t.getIp=function(){/^(?=^.{3,255}$)[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+$/.test(t.domain.ym_name)?n.get("api/getip.php",{ym:t.domain.ym_name},function(n){t.domain.ym_true_ip=n.msg}):(t.error=!0,t.errorMsg="请输入正确的域名")},t.check=function(){return/^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$/.test(t.domain.ym_ip)?!!/^(?=^.{3,255}$)[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+$/.test(t.domain.ym_name)||(t.error=!0,t.errorMsg="请输入正确的域名",!1):(t.error=!0,t.errorMsg="请输入正确的ip地址",!1)},t.sub=function(){!t.loading&&t.check()&&(t.loading=!0,n.post("api/ym_add.php",{ym_name:t.domain.ym_name,ym_ip:t.domain.ym_ip},function(n){0==n.error?t.closeThisDialog(n):(t.error=!0,t.errorMsg=n.msg)}))}}]),app.controller("domain",["$scope","$rootScope","Table","http","ngDialog",function(t,n,e,i,o){n.patchName="domain",t.getIp=function(){t.table.list.forEach(function(t){i.get("api/getip.php",{ym:t.ym_name},function(n){t.ym_true_ip=n.msg})})},t.table=e.init({link:"api/ym_list.php",callback:t.getIp}),t.table.getList(),t.checkValue=[],t.addDomain=function(){o.open({template:"template/addDomainDialog.html",controller:"addDomain"}).closePromise.then(function(n){n.value&&0==n.value.error&&t.table.getList()})},t.changeDomain=function(t,n){i.get("api/ym_status.php",{ym_id:t.ym_id,ym_status:n},function(e){0==e.error&&(t.ym_status=n)})},t.delDomain=function(n){if(n||t.checkValue){var e="",a={};n?(e="您确定要删除域名“"+n.ym_name+"”吗？",a.ym_id=n.ym_id):(e="您确定要删除这些域名吗？",a.ym_id=t.checkValue.join(",")),o.open({template:'<div class="confirm-dialog">                 <h2>'+e+'</h2>                <div align="center">                    <button type="button" class="btn-red" ng-click="closeThisDialog(\'CONFIRM\')">确定</button>                    <button type="button" class="btn" ng-click="closeThisDialog()">取消</button>                </div></div>',plain:!0}).closePromise.then(function(n){n.value&&"CONFIRM"==n.value&&i.post("api/ym_del.php",a,function(n){0==n.error&&t.table.getList()})})}}}])}();